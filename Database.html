<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>pg-promise API</title>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="style.css">
</head>

<body>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-pg-promise.html">pg-promise</a></li></ul><h3>Externals</h3><ul><li><a href="external-Client.html">Client</a></li><li><a href="external-Error.html">Error</a></li><li><a href="external-PG.html">PG</a></li><li><a href="external-pg-minify.html">pg-minify</a></li><li><a href="external-Promise.html">Promise</a></li><li><a href="external-RangeError.html">RangeError</a></li><li><a href="external-Stream.html">Stream</a></li><li><a href="external-TypeError.html">TypeError</a></li></ul><h3>Classes</h3><ul><li><a href="Database.html">Database</a></li><li><a href="errors.ParameterizedQueryError.html">ParameterizedQueryError</a></li><li><a href="errors.PreparedStatementError.html">PreparedStatementError</a></li><li><a href="errors.QueryFileError.html">QueryFileError</a></li><li><a href="errors.QueryResultError.html">QueryResultError</a></li><li><a href="helpers.Column.html">Column</a></li><li><a href="helpers.ColumnSet.html">ColumnSet</a></li><li><a href="helpers.TableName.html">TableName</a></li><li><a href="ParameterizedQuery.html">ParameterizedQuery</a></li><li><a href="PreparedStatement.html">PreparedStatement</a></li><li><a href="PromiseAdapter.html">PromiseAdapter</a></li><li><a href="QueryFile.html">QueryFile</a></li><li><a href="Task.html">Task</a></li><li><a href="txMode.TransactionMode.html">TransactionMode</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:connect">connect</a></li><li><a href="global.html#event:disconnect">disconnect</a></li><li><a href="global.html#event:error">error</a></li><li><a href="global.html#event:extend">extend</a></li><li><a href="global.html#event:query">query</a></li><li><a href="global.html#event:receive">receive</a></li><li><a href="global.html#event:task">task</a></li><li><a href="global.html#event:transact">transact</a></li></ul><h3>Namespaces</h3><ul><li><a href="errors.html">errors</a></li><li><a href="formatting.html">formatting</a></li><li><a href="helpers.html">helpers</a></li><li><a href="txMode.html">txMode</a></li></ul><h3>Global</h3><ul><li><a href="global.html#queryResult">queryResult</a></li></ul>
    <div class="home-link">
        <a href="https://github.com/vitaly-t/pg-promise">&lt;&lt; GitHub</a>
    </div>
</nav>

<div id="main">
    




<section>

<header>
    
        <h2>Database</h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    <h4 class="name" id="Database"><span class="type-signature"></span>new Database<span class="signature">(cn, dc<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Represents the database protocol, extensible via event <a href="global.html#event:extend">extend</a>.
This type is not available directly, it can only be created via the library's base call.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>cn</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Connection object or string. For details see <a href="https://github.com/vitaly-t/pg-promise/wiki/Connection-Syntax">Connection Syntax</a>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dc</code></td>
            

            <td class="type">
            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Database Context.</p>
<p>Any object or value to be propagated through the protocol, to allow implementations
and event handling that depend on the database context.</p>
<p>This is mainly to facilitate the use of multiple databases which may need separate protocol
extensions, or different implementations within a single task / transaction callback,
depending on the database context.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line16">line 16</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="global.html#event:extend">extend</a>,<a href="Database.html#.connect">connect</a>,<a href="Database.html#.query">query</a>,<a href="Database.html#.none">none</a>,<a href="Database.html#.one">one</a>,<a href="Database.html#.oneOrNone">oneOrNone</a>,<a href="Database.html#.many">many</a>,<a href="Database.html#.manyOrNone">manyOrNone</a>,<a href="Database.html#.any">any</a>,<a href="Database.html#.func">func</a>,<a href="Database.html#.proc">proc</a>,<a href="Database.html#.result">result</a>,<a href="Database.html#.map">map</a>,<a href="Database.html#.each">each</a>,<a href="Database.html#.stream">stream</a>,<a href="Database.html#.task">task</a>,<a href="Database.html#.tx">tx</a></li>
        </ul>
    </dd>
    

    
</dl>















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Loading and initializing the library:var pgp = require('pg-promise')({    // Initialization Options});var cn = "postgres://username:password@host:port/database";// Creating a new database instance from the connection details:var db = pgp(cn);</code></pre>



    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id=".any"><span class="type-signature">(static) </span>any<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects any number of rows.</p>
<p>This is simply a shorter alias for method <a href="Database.html#.manyOrNone">manyOrNone</a>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line414">line 414</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.manyOrNone">manyOrNone</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when no rows are returned, it resolves with an empty array</li>
<li>when 1 or more rows are returned, it resolves with the array of rows.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".connect"><span class="type-signature">(static) </span>connect<span class="signature">(options<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Acquires a new or existing connection, based on the current connection parameters.</p>
<p>This method initiates a shared connection for executing a chain of queries against it.
The connection must be released in the end of the chain by calling method <code>done()</code> on the connection object.</p>
<p>This is an older, low-level approach to chaining queries on the same connection.
A newer and safer approach is via methods <a href="Database.html#.task">task</a> and <a href="Database.html#.tx">tx</a> (for transactions),
which allocate and release the shared connection automatically.</p>
<p><strong>NOTE:</strong> Even though this method exposes a <a href="external-Client.html">Client</a> object via property <code>client</code>, you cannot call
<code>client.end()</code> directly, or it will throw <a href="external-Error.html">Error</a> = <code>Cannot invoke client.end() directly.</code>
You can only call method <code>done()</code> to release the connection.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Connection options. <strong>Added in v.4.3.4</strong></p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>direct</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>Creates the connection directly, through the <a href="external-Client.html">Client</a>, bypassing the connection pool.</p>
<p>By default, all connections are acquired from the connection pool. If you set this option, the library will instead
create a new <a href="external-Client.html">Client</a> object, and call its <code>connect</code> method.</p>
<p><strong>WARNING:</strong></p>
<p>Do not use this option for regular query execution, because it exclusively occupies one physical connection,
and therefore cannot scale. This option is only suitable for a global connection usage, such as database event listeners.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line71">line 71</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.task">Database.task</a>,<a href="Database.html#.tx">Database.tx</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the connection result:</p>
<ul>
<li>resolves with the complete <a href="Database.html">Database</a> protocol, extended with:<ul>
<li>property <code>client</code> of type <a href="external-Client.html">Client</a> that represents the open connection</li>
<li>method <code>done()</code> that must be called in the end, in order to release the connection</li>
</ul>
</li>
<li>rejects with the connection error when fails.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>var sco; // shared connection object;db.connect()    .then(function (obj) {        // obj.client = new connected Client object;        sco = obj; // save the connection object;        // execute all the queries you need:        return sco.any('SELECT * FROM Users');    })    .then(function (data) {        // success    })    .catch(function (error) {        // error    })    .finally(function () {        // release the connection, if it was successful:        if (sco) {            sco.done();        }    });</code></pre>



        
            

    

    <h4 class="name" id=".each"><span class="type-signature">(static) </span>each<span class="signature">(query, values<span class="signature-attributes">opt</span>, cb, thisArg<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p><strong>Added in v.4.3.0</strong></p>
<p>Executes a provided function once per array element, for an array of rows resolved by method <a href="Database.html#.any">any</a>.</p>
<p>It is a convenience method to simplify the following code:</p>
<pre class="prettyprint source lang-js"><code>db.any(query, values)
    .then(function(data) {
        data.forEach(function(row, index, data) {
             // process the row
        });
        return data;
    });</code></pre><p>In addition to much shorter code, it offers the following benefits:</p>
<ul>
<li>Use of a custom iterator has a much better performance than the regular <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">Array.forEach</a></li>
<li>Automatic <code>this</code> context through the database protocol</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Function to execute for each row, taking three arguments:</p>
<ul>
<li><code>row</code> - the current row being processed in the array</li>
<li><code>index</code> - the index of the current row being processed in the array</li>
<li><code>data</code> - the array of rows resolved by method <a href="Database.html#.any">any</a></li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>thisArg</code></td>
            

            <td class="type">
            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Value to use as <code>this</code> when executing the callback.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line662">line 662</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.any">any</a>,<a href="Database.html#.map">map</a>,<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">Array.forEach</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Resolves with the original array of rows.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>db.each('SELECT id, code, name FROM Events', null, row => {    row.code = parseInt(row.code);})    .then(data => {        // data = array of events, with 'code' converted into integer    })    .catch(error => {        // error    });</code></pre>



        
            

    

    <h4 class="name" id=".func"><span class="type-signature">(static) </span>func<span class="signature">(funcName, values<span class="signature-attributes">opt</span>, qrm<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query against a database function by its name: <code>SELECT * FROM funcName(values)</code>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>funcName</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Name of the function to be executed.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Parameters for the function - one value or an array of values.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>qrm</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#queryResult">queryResult</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    queryResult.any
                
                </td>
            

            <td class="description last"><p><a href="global.html#queryResult">Query Result Mask</a>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line519">line 519</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.query">query</a>,<a href="Database.html#.proc">proc</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Result of the query call, according to parameter <code>qrm</code>.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".many"><span class="type-signature">(static) </span>many<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects one or more rows.
When the query returns no data, the method rejects.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line302">line 302</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when 1 or more rows are returned, it resolves with the array of rows</li>
<li>when no rows are returned, it rejects with <a href="errors.QueryResultError.html">QueryResultError</a>
= <code>No data returned from the query.</code></li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".manyOrNone"><span class="type-signature">(static) </span>manyOrNone<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects any number of rows.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line378">line 378</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.any">any</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when no rows are returned, it resolves with an empty array</li>
<li>when 1 or more rows are returned, it resolves with the array of rows.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".map"><span class="type-signature">(static) </span>map<span class="signature">(query, values, cb, thisArg<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p><strong>Added in v.4.3.0</strong></p>
<p>Creates a new array with the results of calling a provided function on every element in the array of rows
resolved by method <a href="Database.html#.any">any</a>.</p>
<p>It is a convenience method to simplify the following code:</p>
<pre class="prettyprint source lang-js"><code>db.any(query, values)
    .then(function(data) {
        return data.map(function(row, index, data) {
             // return a new element
        });
    });</code></pre><p>In addition to much shorter code, it offers the following benefits:</p>
<ul>
<li>Use of a custom iterator has a much better performance than the standard <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map">Array.map</a></li>
<li>Automatic <code>this</code> context through the database protocol</li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Function that produces an element of the new array, taking three arguments:</p>
<ul>
<li><code>row</code> - the current row being processed in the array</li>
<li><code>index</code> - the index of the current row being processed in the array</li>
<li><code>data</code> - the original array of rows resolved by method <a href="Database.html#.any">any</a></li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>thisArg</code></td>
            

            <td class="type">
            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Value to use as <code>this</code> when executing the callback.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line570">line 570</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.any">any</a>,<a href="Database.html#.each">each</a>,<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map">Array.map</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Resolves with the new array of values returned from the callback.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    


    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>db.map('SELECT id FROM Users WHERE status = $1', ['active'], row => row.id)    .then(data => {        // data = array of active user id-s    })    .catch(error => {       // error    });</code></pre>

    <pre class="prettyprint"><code>db.tx(t => {    return t.map('SELECT id FROM Users WHERE status = $1', ['active'], row => {       return t.none('UPDATE Events SET checked = $1 WHERE userId = $2', [true, row.id]);    }).then(t.batch);})    .then(data => {        // success    })    .catch(error => {        // error    });</code></pre>



        
            

    

    <h4 class="name" id=".none"><span class="type-signature">(static) </span>none<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects no data to be returned.
If the query returns any kind of data, the method rejects.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line230">line 230</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when no records are returned, it resolves with <code>undefined</code></li>
<li>when any data is returned, it rejects with <a href="errors.QueryResultError.html">QueryResultError</a>
= <code>No return data was expected.</code></li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".one"><span class="type-signature">(static) </span>one<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects exactly one row of data.
When 0 or more than 1 rows are returned, the method rejects.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line265">line 265</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when 1 row is returned, it resolves with that row as a single object;</li>
<li>when no rows are returned, it rejects with <a href="errors.QueryResultError.html">QueryResultError</a>
= <code>No data returned from the query.</code></li>
<li>when multiple rows are returned, it rejects with <a href="errors.QueryResultError.html">QueryResultError</a>
= <code>Multiple rows were not expected.</code></li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".oneOrNone"><span class="type-signature">(static) </span>oneOrNone<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query that expects 0 or 1 rows.
When the query returns more than 1 row, the method rejects.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line337">line 337</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.one">one</a>,<a href="Database.html#.none">none</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>when no rows are returned, it resolves with <code>null</code></li>
<li>when 1 row is returned, it resolves with that row as a single object</li>
<li>when multiple rows are returned, it rejects with <a href="errors.QueryResultError.html">QueryResultError</a>
= <code>Multiple rows were not expected.</code></li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".proc"><span class="type-signature">(static) </span>proc<span class="signature">(procName, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query against a stored procedure via its name: <code>select * from procName(values)</code>,
expecting back 0 or 1 rows.</p>
<p>The method simply forwards into <code>func(funcName, values, queryResult.one|queryResult.none)</code>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>procName</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Name of the stored procedure to be executed.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Parameters for the procedure - one value or an array of values.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line545">line 545</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Database.html#.oneOrNone">oneOrNone</a>,<a href="Database.html#.func">func</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The same result as method <a href="Database.html#.oneOrNone">oneOrNone</a>.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".query"><span class="type-signature">(static) </span>query<span class="signature">(query, values<span class="signature-attributes">opt</span>, qrm<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a generic query request that expects the return data according to parameter <code>qrm</code>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>qrm</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#queryResult">queryResult</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    queryResult.any
                
                </td>
            

            <td class="description last"><p><a href="global.html#queryResult">Query Result Mask</a></p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line168">line 168</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result.</p>
<p>When the query result is an array, it is extended with a hidden property <code>duration</code></p>
<ul>
<li>query duration in milliseconds.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".result"><span class="type-signature">(static) </span>result<span class="signature">(query, values<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a query without any expectation for the return data, to resolve with the
original <a href="https://github.com/brianc/node-postgres/blob/master/lib/result.js#L6">Result</a> object when successful.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Query to be executed, which can any of the following types:</p>
<ul>
<li>A non-empty query string</li>
<li>Prepared Statement <code>{name, text, values, ...}</code> or <a href="PreparedStatement.html">PreparedStatement</a> object</li>
<li>Parameterized Query <code>{text, values, ...}</code> or <a href="ParameterizedQuery.html">ParameterizedQuery</a> object</li>
<li><a href="QueryFile.html">QueryFile</a> object</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>
|

<span class="param-type">value</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Query formatting parameters.</p>
<p>When <code>query</code> is of type <code>string</code> or a <a href="QueryFile.html">QueryFile</a> object, the <code>values</code> can be:</p>
<ul>
<li>a single value - to replace all <code>$1</code> occurrences</li>
<li>an array of values - to replace all <code>$1</code>, <code>$2</code>, ... variables</li>
<li>an object - to apply <a href="https://github.com/vitaly-t/pg-promise#named-parameters">Named Parameters</a> formatting</li>
</ul>
<p>When <code>query</code> is a Prepared Statement or a Parameterized Query (or their class types),
and <code>values</code> is not <code>null</code> or <code>undefined</code>, it is automatically set within such object,
as an override for its internal <code>values</code>.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line452">line 452</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise object that represents the query result:</p>
<ul>
<li>resolves with the original <a href="https://github.com/brianc/node-postgres/blob/master/lib/result.js#L6">Result</a> object, extended with
property <code>duration</code> - query duration in milliseconds.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".stream"><span class="type-signature">(static) </span>stream<span class="signature">(qs, initCB)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Custom data streaming, with the help of <a href="https://github.com/brianc/node-pg-query-stream">pg-query-stream</a>.</p>
<p>This method doesn't work with the <a href="https://github.com/brianc/node-postgres#native-bindings">Native Bindings</a>, and if option <code>pgNative</code>
is set, it will reject with <code>Streaming doesn't work with native bindings.</code></p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>qs</code></td>
            

            <td class="type">
            
                
<span class="param-type">QueryStream</span>


            
            </td>

            

            

            <td class="description last"><p>Stream object of type <a href="https://github.com/brianc/node-pg-query-stream/blob/master/index.js#L5">QueryStream</a>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>initCB</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#streamInitCB">streamInitCB</a></span>


            
            </td>

            

            

            <td class="description last"><p>Stream initialization callback.</p>
<p>It is invoked with the same <code>this</code> context as the calling method.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line486">line 486</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Result of the streaming operation.</p>
<p>Once the streaming has finished successfully, the method resolves with
<code>{processed, duration}</code>:</p>
<ul>
<li><code>processed</code> - total number of rows processed;</li>
<li><code>duration</code> - streaming duration, in milliseconds.</li>
</ul>
<p>Possible rejections messages:</p>
<ul>
<li><code>Invalid or missing stream object.</code></li>
<li><code>Invalid stream state.</code></li>
<li><code>Invalid or missing stream initialization callback.</code></li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id=".task"><span class="type-signature">(static) </span>task<span class="signature">(tag/cb, cb<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>) with an automatically managed connection.</p>
<p>This method should be used whenever executing more than one query at once, so the allocated connection
is reused between all queries, and released only after the task has finished.</p>
<p>The callback function is called with one parameter - database protocol (same as <code>this</code>), extended with methods
<a href="Task.html#.batch">batch</a>, <a href="Task.html#.page">page</a>, <a href="Task.html#.sequence">sequence</a>, plus property <a href="Task.html#.ctx">ctx</a> -
the task context object. See <a href="Task.html">Task</a> for more details.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tag/cb</code></td>
            

            <td class="type">
            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>When the method takes only one parameter, it must be the callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>) for the task.
However, when calling the method with 2 parameters, the first one is always the <code>tag</code> - traceable context for the
task (see <a href="https://github.com/vitaly-t/pg-promise/wiki/workflows#tags">tags</a>).</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Task callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>), if it is not <code>undefined</code>, or else the callback is expected to
be passed in as the first parameter.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line743">line 743</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Task.html">Task</a>,<a href="Database.html#.tx">tx</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Result from the callback function.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// creating a task with a string for the tag:db.task('my-task-name', t=> {        // t.ctx = task context object                // task body, usually returning something    })    .then(data=> {        // success        // data = as returned from the task's callback    })    .catch(error=> {        // error    });</code></pre>



        
            

    

    <h4 class="name" id=".tx"><span class="type-signature">(static) </span>tx<span class="signature">(tag/cb, cb<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="external-Promise.html">external:Promise</a>}</span></h4>

    



<div class="description">
    <p>Executes a callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>) as a transaction.</p>
<p>The transaction will execute <code>ROLLBACK</code> in the end, if the callback function returns a rejected
promise or throws an error, and it will execute <code>COMMIT</code> in all other cases.</p>
<p>The callback function is called with one parameter - database protocol (same as <code>this</code>), extended with methods
<a href="Task.html#.batch">batch</a>, <a href="Task.html#.page">page</a>, <a href="Task.html#.sequence">sequence</a>, plus property <a href="Task.html#.ctx">ctx</a> -
the transaction context object. See <a href="Task.html">Task</a> for more details.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tag/cb</code></td>
            

            <td class="type">
            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>When the method takes only one parameter, it must be the callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>) for the transaction.
However, when calling the method with 2 parameters, the first one is always the <code>tag</code> - traceable context for the
transaction (see <a href="https://github.com/vitaly-t/pg-promise/wiki/workflows#tags">tags</a>).</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">generator</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Transaction callback function (or <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/function*">ES6 generator</a>), if it is not <code>undefined</code>, or else the callback is expected to be
passed in as the first parameter.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="database.js.html">database.js</a>, <a href="database.js.html#line792">line 792</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="Task.html">Task</a>,<a href="Database.html#.task">task</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Result from the callback function.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="external-Promise.html">external:Promise</a></span>


    </dd>
</dl>

    


    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// creating a transaction with a string for the tag:db.tx('my-transaction-name', t=> {        // t.ctx = transaction context object                // transaction body, usually returning something    })    .then(data=> {        // success        // data = as returned from the transaction's callback    })    .catch(error=> {        // error    });</code></pre>



        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"></script>
</body>
</html>